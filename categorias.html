<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Categorias — E o resto é Historia</title>
  <meta name="description" content="Explore nossos artigos organizados por categorias: História Religiosa, História Antiga, História do Brasil e muito mais">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📚</text></svg>">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>E o resto é Historia</h1>
    <nav>
      <a href="index.html">Início</a>
      <a href="sobre.html">Sobre</a>
      <a href="contato.html">Contato</a>
      <a href="categorias.html">Categorias</a>
    </nav>
    <button id="toggle-dark-mode" aria-label="Alternar modo escuro">🌙</button>
  </header>

  <nav class="breadcrumb">
    <a href="index.html">Início</a> > <span>Categorias</span>
  </nav>

  <main class="container">
    <div class="categories-page">
      <section class="categories-hero">
        <h1>📚 Categorias</h1>
        <p>Explore nossos artigos organizados por temas. Encontre exatamente o que você está procurando!</p>
      </section>

      <div class="categories-grid" id="categories-grid">
        <!-- Categorias serão geradas dinamicamente -->
      </div>

      <section class="category-posts" id="category-posts" style="display: none;">
        <div class="category-header">
          <h2 id="category-title">Artigos da Categoria</h2>
          <button class="btn-secondary" onclick="showAllCategories()">← Voltar às Categorias</button>
        </div>
        <div class="grid-posts" id="category-articles"></div>
      </section>

      <section class="popular-tags">
        <h2>🏷️ Tags Populares</h2>
        <div class="tags-cloud">
          <span class="tag-cloud">Cristianismo</span>
          <span class="tag-cloud">Império Romano</span>
          <span class="tag-cloud">Brasil Colônia</span>
          <span class="tag-cloud">Feudalismo</span>
          <span class="tag-cloud">Renascimento</span>
          <span class="tag-cloud">Revolução Industrial</span>
          <span class="tag-cloud">Guerra Mundial</span>
          <span class="tag-cloud">Civilizações</span>
          <span class="tag-cloud">Cultura</span>
          <span class="tag-cloud">Sociedade</span>
        </div>
      </section>

      <section class="archive-section">
        <h2>📅 Arquivo por Data</h2>
        <div class="archive-grid">
          <div class="archive-item">
            <h3>2025</h3>
            <ul>
              <li><a href="#">Janeiro (<span id="jan-count">0</span> artigos)</a></li>
              <li><a href="#">Dezembro 2024 (<span id="dec-count">0</span> artigos)</a></li>
              <li><a href="#">Novembro 2024 (<span id="nov-count">0</span> artigos)</a></li>
            </ul>
          </div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>E o resto é Historia</h3>
        <p>Blog dedicado ao ensino de História, cultura e sociedade.</p>
      </div>
      <div class="footer-section">
        <h3>Links Úteis</h3>
        <ul>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="contato.html">Contato</a></li>
          <li><a href="categorias.html">Categorias</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>© 2025 Blog do Professor de História — Todos os direitos reservados.</p>
    </div>
  </footer>

  <button id="scroll-top" class="scroll-top" aria-label="Voltar ao topo">↑</button>

  <script src="posts.js"></script>
  <script>
    // ==== GERAR CATEGORIAS DINAMICAMENTE ====
    document.addEventListener('DOMContentLoaded', function() {
      const categoriesGrid = document.getElementById('categories-grid');
      
      Object.keys(categories).forEach(categoryKey => {
        const category = categories[categoryKey];
        const articleCount = analytics.getArticlesByCategory(categoryKey);
        const viewCount = analytics.getViewsByCategory(categoryKey);
        
        const card = document.createElement('div');
        card.className = 'category-card';
        card.innerHTML = `
          <div class="category-icon">${category.icon}</div>
          <h2>${category.name}</h2>
          <p>${category.description}</p>
          <div class="category-stats">
            <span>📄 ${articleCount} artigos</span>
            <span>👁️ ${analytics.formatViews(viewCount)} visualizações</span>
          </div>
          <a href="#" class="btn category-btn" data-category="${categoryKey}">Ver Artigos</a>
        `;
        categoriesGrid.appendChild(card);
      });
      
      // Atualizar contadores de arquivo
      if (document.getElementById('jan-count')) {
        const janCount = posts.filter(p => new Date(p.data).getMonth() === 0).length;
        const decCount = posts.filter(p => new Date(p.data).getMonth() === 11).length;
        const novCount = posts.filter(p => new Date(p.data).getMonth() === 10).length;
        
        document.getElementById('jan-count').textContent = janCount;
        document.getElementById('dec-count').textContent = decCount;
        document.getElementById('nov-count').textContent = novCount;
      }
    });

    // ==== SHOW CATEGORY POSTS ====
    function showCategoryPosts(categoryKey) {
      const categoriesGrid = document.getElementById('categories-grid');
      const categoryPostsSection = document.getElementById('category-posts');
      const categoryTitle = document.getElementById('category-title');
      const categoryArticles = document.getElementById('category-articles');
      
      // Esconder grid de categorias
      categoriesGrid.style.display = 'none';
      
      // Mostrar seção de posts
      categoryPostsSection.style.display = 'block';
      
      // Atualizar título
      categoryTitle.textContent = `Artigos de ${categories[categoryKey].name}`;
      
      // Filtrar posts da categoria
      const filteredPosts = posts.filter(post => post.tags.includes(categoryKey));
      
      // Limpar container
      categoryArticles.innerHTML = '';
      
      if (filteredPosts.length === 0) {
        categoryArticles.innerHTML = `
          <div class="no-posts" style="text-align: center; padding: 3rem; background: var(--card-bg); border-radius: 15px; margin: 2rem 0;">
            <h3>📝 Em breve!</h3>
            <p>Ainda não temos artigos nesta categoria, mas estamos trabalhando nisso!</p>
            <button class="btn" onclick="showAllCategories()">← Voltar às Categorias</button>
          </div>
        `;
      } else {
        filteredPosts.forEach(post => {
          const card = document.createElement('article');
          card.className = 'card';
          card.innerHTML = `
            <img src="${post.imagem}" alt="${post.titulo}" loading="lazy">
            <div class="card-content">
              <h3>${post.titulo}</h3>
              <div class="tags">
                ${post.tags.map(tag => `<span>${tag.replace(/-/g,' ')}</span>`).join('')}
              </div>
              <p>${post.descricao}</p>
              <a href="${post.url}" class="btn">Ler mais</a>
              <button class="like-btn" data-id="${post.id}">
                ❤️ <span class="like-count">0</span>
              </button>
            </div>
          `;
          categoryArticles.appendChild(card);
        });
        
        // Inicializar likes para os novos posts
        initializeLikeButtons();
      }
      
      // Scroll para o topo da seção
      categoryPostsSection.scrollIntoView({ behavior: 'smooth' });
    }

    // ==== SHOW ALL CATEGORIES ====
    function showAllCategories() {
      const categoriesGrid = document.getElementById('categories-grid');
      const categoryPostsSection = document.getElementById('category-posts');
      
      categoriesGrid.style.display = 'grid';
      categoryPostsSection.style.display = 'none';
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ==== INICIALIZAR LIKES ====
    function initializeLikeButtons() {
      const likeButtons = document.querySelectorAll('.like-btn');
      likeButtons.forEach(btn => {
        const postId = btn.dataset.id;
        const countSpan = btn.querySelector('.like-count');
        
        if (!localStorage.getItem(`like-${postId}`)) {
          localStorage.setItem(`like-${postId}`, '0');
        }
        countSpan.textContent = localStorage.getItem(`like-${postId}`);
        
        btn.addEventListener('click', () => {
          let current = parseInt(localStorage.getItem(`like-${postId}`));
          current++;
          localStorage.setItem(`like-${postId}`, current);
          countSpan.textContent = current;
          btn.classList.add('liked');
          
          btn.style.transform = 'scale(1.2)';
          setTimeout(() => {
            btn.style.transform = 'scale(1)';
          }, 200);
        });
      });
    }

    // ==== CATEGORY BUTTONS ====
    document.addEventListener('click', function(e) {
      if (e.target.classList.contains('category-btn')) {
        e.preventDefault();
        const categoryKey = e.target.dataset.category;
        showCategoryPosts(categoryKey);
      }
    });

    // ==== TAG CLOUD ====
    document.querySelectorAll('.tag-cloud').forEach(tag => {
      tag.addEventListener('click', function() {
        alert(`Buscando artigos sobre: ${this.textContent}`);
      });
    });
  </script>
  <script src="main.js"></script>
</body>
</html>